# CLIST Contest Calendar Helper

<div align="center">
<a href="#english">English</a> | <a href="#中文">中文</a>
</div>

---

<details open>
<summary><strong>English</strong></summary>

<a id="english"></a>

> This project was generated by AI.

## Overview
This repository contains a small Python utility that retrieves upcoming competitive programming contests from the CLIST API and exports them as an iCalendar (.ics) file that you can import into TickTick or any other calendar application.

## Features
- Fetches contests for popular platforms such as LeetCode, Codeforces, AtCoder, Luogu, and Nowcoder by default.
- Supports custom resource filters, per-resource limits, and date windows.
- Generates standards-compliant ICS events with rich descriptions and platform categories.
- Provides an interactive helper that stores credentials locally to streamline repeated exports.

## Requirements
- Python 3.9 or later.
- A CLIST account with API access (username and API key).
- Network access to https://clist.by/api/v2.

## Setup
- Clone or download this repository.
- (Optional) Create and activate a virtual environment for isolation.
- No third-party dependencies are required; the Python standard library is sufficient.

```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
python --version
```

## Obtain CLIST API credentials
- Sign in at https://clist.by and open your profile settings.
- Generate an API key (or reuse an existing key) and note your CLIST username.
- Keep these values available for the helper prompts or set them as environment variables.

## Usage

### Interactive helper (`clist_helper.py`)
Run the helper to be guided through credential entry, time window selection, and output path.

```powershell
python clist_helper.py
```

Key behavior:
- Saved credentials are stored in `clist_credentials.json`. You can reuse, replace, or delete them from within the helper.
- The script can filter contests that start after or end before an ISO timestamp (for example `2025-01-01T00:00:00+00:00`).
- Output defaults to `contests.ics`; provide any writable path to change it.

### Direct CLI (`clist_to_ics.py`)
Use the lower-level script if you prefer full control or want to automate exports.

```powershell
python clist_to_ics.py --username YOUR_USERNAME --api-key YOUR_API_KEY --resources codeforces atcoder --starts-after 2025-01-01T00:00:00+00:00 --output contests.ics
```

You may also set `CLIST_API_USERNAME` and `CLIST_API_KEY` environment variables instead of passing the flags.

Common options:
- `--resources`: Aliases, hosts, or numeric resource IDs. Defaults to `leetcode codeforces atcoder luogu nowcoder`.
- `--starts-after` / `--ends-before`: ISO timestamps used to bound the contest start times.
- `--include-ended`: Include contests that have already finished (off by default).
- `--per-resource-limit`: Limit contests fetched per platform (default 50, 0 means unlimited).
- `--max-contests`: Trim the merged result to the first N contests.
- `--calendar-name`: Override the calendar display name in the ICS output.
- `--product-id`: Customize the ICS `PRODID` header.
- `--output`: Destination path for the generated file.

## Resource aliases
The helper understands these shortcuts in addition to full hostnames:
- `leetcode`, `lc` -> `leetcode.com`
- `codeforces`, `cf` -> `codeforces.com`
- `atcoder`, `ac` -> `atcoder.jp`
- `luogu`, `lg` -> `luogu.com.cn`
- `nowcoder`, `nk` -> `ac.nowcoder.com`

Use numeric IDs if you need a platform that is not listed above.

## Saved credentials
The helper writes `clist_credentials.json` in the repository root so you can skip re-entering your username and API key. Delete the file manually or choose the helper option to remove it if you want to purge stored data.

## Importing the calendar
The generated `.ics` file can be imported into TickTick, Google Calendar, Outlook, or any other iCalendar-compatible client. Each event includes:
- A summary of the platform and contest title.
- Start and end timestamps in UTC.
- A rich description with the contest URL and duration.
- A category set to the platform name for filtering.

## Troubleshooting
- **No contests retrieved**: Broaden the time window, add `--include-ended`, or remove restrictive resource filters.
- **CLIST API error**: Confirm your username/API key combination and verify that your account has API access. Temporary network issues can also cause failures.
- **Time parsing errors**: Provide ISO 8601 timestamps such as `2025-01-10T12:00:00+00:00` or append `Z` for UTC.

## License
This project is distributed under the MIT License. See `LICENSE` for details.

</details>

<details>
<summary><strong>中文</strong></summary>

<a id="中文"></a>

> 该项目由ai生成

## 项目简介
该仓库提供一套 Python 工具，可从 CLIST API 拉取近期的竞赛信息，并导出为 iCalendar (`.ics`) 文件，方便导入 TickTick 或其他日历应用。

## 功能亮点
- 默认支持拉取 LeetCode、Codeforces、AtCoder、Luogu、Nowcoder 等常见平台的比赛。
- 支持自定义平台筛选、按平台限制比赛数量以及设定时间窗口。
- 生成符合标准的 ICS 事件，包含详细描述和平台分类信息。
- 提供交互式助手，可在本地保存凭证，便于重复导出。

## 环境要求
- Python 3.9 及以上版本。
- 拥有 CLIST 账户及 API 权限（用户名和 API Key）。
- 能访问 https://clist.by/api/v2 网络。

## 安装与环境准备
- 克隆或下载本仓库。
- （可选）创建并激活虚拟环境，隔离依赖。
- 脚本仅使用标准库，无需额外三方依赖。

```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
python --version
```

## 获取 CLIST API 凭证
- 登录 https://clist.by ，进入个人资料设置。
- 生成或查看已有的 API Key，记录对应的用户名。
- 可在运行助手时输入这些信息，或提前写入环境变量。

## 使用方式

### 交互式助手（`clist_helper.py`）
运行助手脚本，根据提示输入凭证、时间范围和输出路径。

```powershell
python clist_helper.py
```

关键行为：
- 凭证会保存在仓库根目录的 `clist_credentials.json`，可在助手中选择复用、替换或删除。
- 支持按 ISO 时间（如 `2025-01-01T00:00:00+00:00`）筛选开始和结束时间。
- 输出文件默认是 `contests.ics`，也可以填写任意可写路径。

### 命令行脚本（`clist_to_ics.py`）
适合需要完全掌控参数或自动化任务的场景。

```powershell
python clist_to_ics.py --username YOUR_USERNAME --api-key YOUR_API_KEY --resources codeforces atcoder --starts-after 2025-01-01T00:00:00+00:00 --output contests.ics
```

也可设置环境变量 `CLIST_API_USERNAME` 与 `CLIST_API_KEY`，无需在命令行传参。

常用选项：
- `--resources`：平台别名、域名或资源 ID，默认值为 `leetcode codeforces atcoder luogu nowcoder`。
- `--starts-after` / `--ends-before`：通过 ISO 时间限制比赛开始范围。
- `--include-ended`：包含已结束的比赛（默认关闭）。
- `--per-resource-limit`：限制每个平台拉取的比赛数量（默认 50，设为 0 表示不限）。
- `--max-contests`：汇总后仅保留前 N 场比赛。
- `--calendar-name`：覆盖 ICS 中显示的日历名称。
- `--product-id`：自定义 ICS `PRODID` 头信息。
- `--output`：生成文件的输出路径。

## 资源别名
助手除了支持完整域名，也理解以下常用缩写：
- `leetcode`、`lc` -> `leetcode.com`
- `codeforces`、`cf` -> `codeforces.com`
- `atcoder`、`ac` -> `atcoder.jp`
- `luogu`、`lg` -> `luogu.com.cn`
- `nowcoder`、`nk` -> `ac.nowcoder.com`

若需其他平台，可直接使用其资源 ID。

## 凭证保存位置
助手会在仓库根目录写入 `clist_credentials.json`，便于下次直接使用。如果需要清除，可手动删除或在助手中选择相应选项。

## 导入日历
生成的 `.ics` 文件可导入 TickTick、Google Calendar、Outlook 等任何支持 iCalendar 的客户端。每个事件包含：
- 平台与比赛标题组成的摘要。
- 以 UTC 表示的开始与结束时间。
- 包含比赛链接和持续时间的详细描述。
- 以平台名作为分类，方便过滤。

## 常见问题
- **未获取到比赛**：请放宽时间范围、添加 `--include-ended`，或减少筛选条件。
- **CLIST API 报错**：确认用户名/API Key 是否正确，并确保账户拥有 API 权限，也可能是暂时的网络问题。
- **时间解析失败**：请使用 `2025-01-10T12:00:00+00:00` 这类 ISO 8601 时间格式，或在 UTC 时间后加 `Z`。

## 许可证
本项目基于 MIT License 发布，详见 `LICENSE`。

</details>
